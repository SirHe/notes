# 如何设计一个高性能的 WEB 服务器

## 程序设计的终极目标

先想办法拉满硬件（CPU 等），然后在硬件拉满的情况下，考虑任务分优先级（先后处理）

主要的设计点有：
1、多任务同时进行，如何总用时最少
2、不同硬件模块处理速度不一样，如何协调保证总效率最高（磁盘与 CPU 速度不匹配）
3、内存读取速度与利用率的矛盾（顺序 IO 与随机 IO）

# 如何拉满单机性能？

1、单进程单线程
2、单进程多线程
3、多进程单线程
4、多进程多线程

线程池（连接池、PPC 与 TPC）
reactor 与 proactor

# 集群

1、纵向拆分
只要 nignx 作转发，配置合适的转发策略即可
2、横向拆分
按业务模块拆分，比如登陆系统、主业务系统等。

# 案例分析

node 架构设计分析
egg 进程模型分析
Java 进程模型分析
spring 是如何做的：1、如何充分利用多核 cpu 资源？；2、如何解决数据加载（IO）与数据处理（CPU）速度不匹配问题？

# 其他

为什么 node 不适合 CPU 密集型场景？js 语言太过灵活，兼容情况太多，导致兼容处理的时间占比过大

# 关于 egg 的几个问题

1、worker 线程池是怎么维护的？
2、请求的分发策略具体是怎样的？

# 参考

-   [Which is correct Node.js architecture?](https://stackoverflow.com/questions/36766696/which-is-correct-node-js-architecture)
